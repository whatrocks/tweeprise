<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Tweeprise</title>
    <link rel="stylesheet" type="text/css" href="assets/css/main.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <header>

        <h1>Tweeprise</h1>
        <!--And now just for fun-->
        <marquee>It's gonna be cold cold cold cold cold.</marquee>

    </header>
    
    <section>
  
      <button class="refresh-tweets">Show New Tweets</button>
      
      <div class="feed"></div>

    </section>
    
    <footer>

      <p> Created by @whatrocks for @hackreactor </p>

    </footer>


    <script>

      $(document).ready(function(){
        var $feed = $('.feed');
        $feed.html('');

        var shownTweets = 0;

        var showTweets = function(startCount, userName) {
          
          var index;
          
          var count;

          if (!startCount) {
            count = 0;
          } else {
            count = startCount;
          }

          var tweetArray;

          if (!userName) {
            index = streams.home.length - 1;
            tweetArray = streams.home;
          } else {
            index = streams.users[userName].length - 1;
            tweetArray = streams.users[userName];
          }

          for (var i = count; i < index; i++) {

            var tweet = tweetArray[i];
            
            var $tweet = $('<div/>', {'class': 'tweetContainer'});
            var date = tweet.created_at.getHours() +":"+tweet.created_at.getMinutes() +":"+tweet.created_at.getSeconds();
            $tweet.append($('<div/>', {'class': 'tweetUserName', 'data-username': tweet.user, text: "@"+tweet.user }));
            $tweet.append($('<div/>', {'class': 'tweetDate', text: date}));
            $tweet.append($('<div/>', {'class': 'tweetMessage', text: tweet.message}));

            $tweet.prependTo($feed);
            shownTweets += 1;

           }
        };

        // Initial page load
        showTweets();

        $('.refresh-tweets').on('click', function() {
          showTweets(shownTweets);
        });

        $('.feed').on('click', '.tweetUserName', function() {
          $feed.html('');
          var clickedUser = $(this).data('username');
          console.log(clickedUser);
          showTweets(0, clickedUser);
        });


      });
    </script>
  </body>
</html>
